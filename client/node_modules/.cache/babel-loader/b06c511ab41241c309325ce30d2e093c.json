{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\utente\\\\Desktop\\\\React tutorial\\\\react-backed\\\\todo-list\\\\src\\\\components\\\\Login.js\";\nimport React from 'react';\nimport './style/Login.css';\nimport { Redirect } from \"react-router-dom\";\n\nvar SHA256 = require(\"crypto-js/sha256\");\n\nclass Login extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      usernameErr: false,\n      passwordErr: false\n    };\n  }\n\n  render() {\n    if (sessionStorage.getItem('isValidLogin') === \"true\" && sessionStorage.getItem('sessionId') !== \"undefined\") {\n      return React.createElement(Redirect, {\n        to: \"/home\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 23\n        },\n        __self: this\n      });\n    } else return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 27\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: (Login.showNotify ? \"w3-animate-opacity\" : \"hidden-opacity\") + \" w3-panel w3-margin w3-display-bottomleft w3-border w3-border-dark-grey overlay \" + Login.notifyClass,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 28\n      },\n      __self: this\n    }, Login.notifyText.split('\\n').map((item, i) => React.createElement(\"p\", {\n      key: i,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 29\n      },\n      __self: this\n    }, item))), React.createElement(\"div\", {\n      className: \"w3-Login w3-display-middle w3-border w3-border-blue w3-padding w3-white login-body\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 32\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"w3-Login w3-border-bottom w3-center\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 33\n      },\n      __self: this\n    }, React.createElement(\"h1\", {\n      className: \"w3-text-pink\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 34\n      },\n      __self: this\n    }, \"Login\")), React.createElement(\"div\", {\n      className: \"w3-Login w3-center\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 37\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 38\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 39\n      },\n      __self: this\n    }, \"Username\"), React.createElement(\"input\", {\n      placeholder: \"Insert username\",\n      className: (this.state.usernameErr ? \"w3-border w3-border-red\" : \"\") + \" w3-input login-input\",\n      ref: \"usernameInput\",\n      type: \"text\",\n      onChange: () => this.validateUername(this.refs.usernameInput.value),\n      onKeyDown: e => this.handleLogin(this.refs.usernameInput.value, this.refs.passwordInput.value, e),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 40\n      },\n      __self: this\n    })), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 43\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 44\n      },\n      __self: this\n    }, \"Password\"), React.createElement(\"input\", {\n      placeholder: \"Insert password\",\n      className: (this.state.passwordErr ? \"w3-border-red\" : \"\") + \" w3-input login-input\",\n      ref: \"passwordInput\",\n      type: \"password\",\n      onChange: () => this.validatePassword(this.refs.passwordInput.value),\n      onKeyDown: e => this.handleLogin(this.refs.usernameInput.value, this.refs.passwordInput.value, e),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 45\n      },\n      __self: this\n    }))), React.createElement(\"div\", {\n      className: \"w3-Login w3-padding w3-center\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 48\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      className: \"login-button w3-btn w3-blue w3-margin\",\n      onClick: () => this.handleLogin(this.refs.usernameInput.value, this.refs.passwordInput.value),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 49\n      },\n      __self: this\n    }, \"Login\"), React.createElement(\"button\", {\n      className: \"login-button w3-btn w3-border w3-border-pink w3-margin w3-center\",\n      onClick: () => this.handleSignUp(this.refs.usernameInput.value, this.refs.passwordInput.value),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 50\n      },\n      __self: this\n    }, \"Sign up\"))));\n  }\n\n  validateUername(username) {\n    this.setState({\n      usernameErr: username.length > 32 || username.length < 5\n    });\n  }\n\n  validatePassword(password) {\n    this.setState({\n      passwordErr: password.length > 32 || password.length < 5\n    });\n  }\n\n  handleLogin(username, password, e) {\n    if (this.state.usernameErr) {\n      this.handleNotify(\"Username is not valid\", \"w3-red\");\n      this.setState({});\n      return;\n    }\n\n    if (this.state.passwordErr) {\n      this.handleNotify(\"Password is not valid\", \"w3-red\");\n      this.setState({});\n      return;\n    }\n\n    if (e.key !== \"Enter\" && e.key !== undefined) return;\n    fetch('/login', {\n      method: 'post',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        \"username\": username,\n        \"password\": SHA256(password).toString()\n      })\n    }).then(res => res.json()).then(result => {\n      if (result.valid) {\n        sessionStorage.setItem('isValidLogin', result.valid);\n        sessionStorage.setItem('sessionId', result.sessionId);\n        this.setState({});\n      } else {\n        sessionStorage.setItem('isValidLogin', \"false\");\n        sessionStorage.setItem('sessionId', \"\");\n        this.handleNotify(\"Username or password not valid\", \"w3-red\");\n        this.setState({\n          usernameErr: true,\n          passwordErr: true\n        });\n      }\n    });\n  }\n\n  handleSignUp(username, password) {\n    if (this.state.usernameErr) {\n      this.handleNotify(\"Username is not valid\", \"w3-red\");\n      this.setState({});\n      return;\n    }\n\n    if (this.state.passwordErr) {\n      this.handleNotify(\"Password is not valid\", \"w3-red\");\n      this.setState({});\n      return;\n    }\n\n    fetch('/signUp', {\n      method: 'post',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        \"username\": username,\n        \"password\": SHA256(password).toString()\n      })\n    }).then(res => res.json()).then(result => {\n      this.handleNotify(result.err === \"usr_alr_exs\" ? \"Username already used\" : \"Sign Up successful\\nYou can now login\", result.err === \"usr_alr_exs\" ? \"w3-red\" : \"w3-green\");\n      this.setState({});\n    });\n  }\n\n  handleNotify(text, className) {\n    Login.notifyText = text;\n    Login.showNotify = true;\n    Login.notifyClass = className;\n    if (Login.notifyTimeoutFunction) clearTimeout(Login.notifyTimeoutFunction);\n    Login.notifyTimeoutFunction = setTimeout(function () {\n      Login.showNotify = false;\n      this.setState({});\n    }.bind(this), 3 * 1000);\n  }\n\n}\n\nLogin.notifyText = '';\nLogin.showNotify = false;\nLogin.notifyClass = \"w3-dark-grey\";\nexport default Login;","map":{"version":3,"sources":["C:\\Users\\utente\\Desktop\\React tutorial\\react-backed\\todo-list\\src\\components\\Login.js"],"names":["React","Redirect","SHA256","require","Login","Component","constructor","props","state","usernameErr","passwordErr","render","sessionStorage","getItem","showNotify","notifyClass","notifyText","split","map","item","i","validateUername","refs","usernameInput","value","e","handleLogin","passwordInput","validatePassword","handleSignUp","username","setState","length","password","handleNotify","key","undefined","fetch","method","headers","body","JSON","stringify","toString","then","res","json","result","valid","setItem","sessionId","err","text","className","notifyTimeoutFunction","clearTimeout","setTimeout","bind"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport './style/Login.css';\r\n\r\nimport { Redirect  } from \"react-router-dom\";\r\nvar SHA256 = require(\"crypto-js/sha256\");\r\n\r\nclass Login extends React.Component {\r\n\r\n\tstatic notifyText = '';\r\n\tstatic showNotify = false;\r\n\tstatic notifyClass = \"w3-dark-grey\";\r\n\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.state = {\r\n\t\t\tusernameErr: false,\r\n\t\t\tpasswordErr: false,\r\n\t\t}\r\n\t}\r\n\r\n\trender() {\r\n\t\tif(sessionStorage.getItem('isValidLogin') === \"true\" && sessionStorage.getItem('sessionId') !== \"undefined\") {\r\n\t\t\treturn (<Redirect to=\"/home\"/>);\r\n\t\t}\r\n\t\telse\r\n\t\t\treturn (\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<div className={(Login.showNotify ? \"w3-animate-opacity\" : \"hidden-opacity\") + \" w3-panel w3-margin w3-display-bottomleft w3-border w3-border-dark-grey overlay \"+Login.notifyClass }>\r\n\t\t\t\t\t{Login.notifyText.split('\\n').map((item, i) => <p key={i}>{item}</p>)}\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div className=\"w3-Login w3-display-middle w3-border w3-border-blue w3-padding w3-white login-body\">\r\n\t\t\t\t\t\t<div className=\"w3-Login w3-border-bottom w3-center\">\r\n\t\t\t\t\t\t  <h1 className=\"w3-text-pink\">Login</h1>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div className=\"w3-Login w3-center\">\r\n\t\t\t\t\t\t\t<p>\r\n\t\t\t         <label>Username</label>\r\n\t\t\t\t\t\t\t <input placeholder=\"Insert username\" className={(this.state.usernameErr ? \"w3-border w3-border-red\" : \"\") +\" w3-input login-input\"} ref=\"usernameInput\" type=\"text\" onChange={() => this.validateUername(this.refs.usernameInput.value)} onKeyDown={(e) => this.handleLogin(this.refs.usernameInput.value,this.refs.passwordInput.value,e)}/>\r\n\t\t\t\t\t\t\t</p>\r\n\r\n\t\t\t\t\t\t\t<p>\r\n\t\t\t\t\t\t\t <label>Password</label>\r\n\t\t\t\t\t\t\t <input placeholder=\"Insert password\" className={(this.state.passwordErr ? \"w3-border-red\" : \"\") + \" w3-input login-input\"} ref=\"passwordInput\" type=\"password\" onChange={() => this.validatePassword(this.refs.passwordInput.value)} onKeyDown={(e) => this.handleLogin(this.refs.usernameInput.value,this.refs.passwordInput.value,e)}/>\r\n\t\t\t\t\t\t\t</p>\r\n\t\t\t       </div>\r\n\t\t\t\t\t\t <div className=\"w3-Login w3-padding w3-center\">\r\n\t\t\t\t\t\t \t<button className=\"login-button w3-btn w3-blue w3-margin\" onClick={() => this.handleLogin(this.refs.usernameInput.value,this.refs.passwordInput.value)}>Login</button>\r\n\t\t\t\t\t\t\t<button className=\"login-button w3-btn w3-border w3-border-pink w3-margin w3-center\" onClick={() => this.handleSignUp(this.refs.usernameInput.value,this.refs.passwordInput.value)}>Sign up</button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t);\r\n\t}\r\n\r\n\tvalidateUername(username) {\r\n\t\t\tthis.setState({usernameErr: username.length>32 || username.length < 5});\r\n\t}\r\n\r\n\tvalidatePassword(password) {\r\n\t\t\tthis.setState({passwordErr: password.length>32 || password.length < 5});\r\n\t}\r\n\r\n\thandleLogin(username,password,e) {\r\n\t\tif(this.state.usernameErr) {\r\n\t\t\tthis.handleNotify(\"Username is not valid\",\"w3-red\");\r\n\t\t\tthis.setState({});\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif(this.state.passwordErr) {\r\n\t\t\tthis.handleNotify(\"Password is not valid\",\"w3-red\");\r\n\t\t\tthis.setState({});\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif(e.key !==\"Enter\" && e.key!==undefined)\r\n\t\t\treturn;\r\n\t\tfetch('/login',{\r\n\t\t\t method: 'post',\r\n\t\t\t headers: {'Content-Type':'application/json'},\r\n\t\t\t body: JSON.stringify({\r\n\t\t\t\t\"username\": username,\r\n\t\t\t\t\"password\": SHA256(password).toString()\r\n\t\t\t})\r\n\t\t})\r\n\t\t.then(res => res.json())\r\n\t\t.then(result => {\r\n\t\t\tif(result.valid) {\r\n\t\t\t\tsessionStorage.setItem('isValidLogin',result.valid);\r\n\t\t\t\tsessionStorage.setItem('sessionId',result.sessionId);\r\n\t\t\t\tthis.setState({});\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tsessionStorage.setItem('isValidLogin',\"false\");\r\n\t\t\t\tsessionStorage.setItem('sessionId',\"\");\r\n\t\t\t\tthis.handleNotify(\"Username or password not valid\",\"w3-red\");\r\n\t\t\t\tthis.setState({usernameErr:true,passwordErr:true});\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\thandleSignUp(username,password) {\r\n\t\tif(this.state.usernameErr) {\r\n\t\t\tthis.handleNotify(\"Username is not valid\",\"w3-red\");\r\n\t\t\tthis.setState({});\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif(this.state.passwordErr) {\r\n\t\t\tthis.handleNotify(\"Password is not valid\",\"w3-red\");\r\n\t\t\tthis.setState({});\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tfetch('/signUp',{\r\n\t\t\t method: 'post',\r\n\t\t\t headers: {'Content-Type':'application/json'},\r\n\t\t\t body: JSON.stringify({\r\n\t\t\t\t\"username\": username,\r\n\t\t\t\t\"password\": SHA256(password).toString()\r\n\t\t\t})\r\n\t\t})\r\n\t\t.then(res => res.json())\r\n\t\t.then(result => {\r\n\r\n\t\t\tthis.handleNotify(result.err === \"usr_alr_exs\" ? \"Username already used\" : \"Sign Up successful\\nYou can now login\",result.err === \"usr_alr_exs\" ? \"w3-red\" : \"w3-green\");\r\n\t\t\tthis.setState({});\r\n\t\t});\r\n\r\n\t}\r\n\r\n\thandleNotify(text,className) {\r\n\t\tLogin.notifyText = text;\r\n\t\tLogin.showNotify = true;\r\n\t\tLogin.notifyClass = className;\r\n\r\n\t\tif(Login.notifyTimeoutFunction)\r\n\t\t\tclearTimeout(Login.notifyTimeoutFunction)\r\n\r\n\t Login.notifyTimeoutFunction =\tsetTimeout(function(){\r\n\t\t\tLogin.showNotify = false;\r\n      this.setState({});\r\n        }.bind(this),3 * 1000);\r\n\t}\r\n}\r\n\r\nexport default Login;\r\n"]},"metadata":{},"sourceType":"module"}