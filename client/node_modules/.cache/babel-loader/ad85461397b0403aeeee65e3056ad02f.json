{"ast":null,"code":"import _defineProperty from \"C:\\\\Users\\\\utente\\\\Desktop\\\\React tutorial\\\\react-backed\\\\todo-list\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";\nvar _jsxFileName = \"C:\\\\Users\\\\utente\\\\Desktop\\\\React tutorial\\\\react-backed\\\\todo-list\\\\src\\\\components\\\\Container.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React from 'react';\nimport './Container.css';\nimport ElementPusher from './ElementPusher';\nimport ItemsList from './ItemsList';\nimport { Redirect } from \"react-router-dom\";\n\nconst uuidv4 = require('uuid/v4');\n\nclass Container extends React.Component {\n  componentWillUnmount() {\n    this._isMounted = false;\n  }\n\n  componentDidMount() {\n    this._isMounted = true;\n\n    if (sessionStorage.getItem('isValidLogin')) {\n      fetch('/getTasks', {\n        method: 'post',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          sessionId: sessionStorage.getItem('sessionId')\n        })\n      }).then(res => res.json()).then(result => {\n        result = result.map(o => o = _objectSpread({}, o, {\n          date: new Date(o.date)\n        }));\n        if (this._isMounted) this.setState({\n          items: result\n        });\n      });\n    }\n  }\n\n  constructor(props) {\n    super(props);\n    this._isMounted = false;\n    this.state = {\n      items: [],\n      instances: []\n    };\n  }\n\n  render() {\n    if (!sessionStorage.getItem('isValidLogin') || !sessionStorage.getItem('sessionId')) {\n      console.log('redir to login');\n      return React.createElement(Redirect, {\n        to: \"/login\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 51\n        },\n        __self: this\n      });\n    }\n\n    if (Container.sessionErr) return React.createElement(Redirect, {\n      to: \"/error\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 55\n      },\n      __self: this\n    });\n    return React.createElement(\"div\", {\n      className: \"w3-container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 58\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: (Container.showNotify ? \"w3-animate-opacity\" : \"hidden-opacity\") + \" w3-panel w3-margin w3-display-bottomleft w3-dark-grey w3-border w3-border-dark-grey overlay\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 59\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 60\n      },\n      __self: this\n    }, Container.notifyText)), React.createElement(\"div\", {\n      className: \"w3-container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 62\n      },\n      __self: this\n    }, React.createElement(ElementPusher, {\n      logOut: () => this.handleLogOut(),\n      onClick: name => this.handleAddElement(name),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 63\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 65\n      },\n      __self: this\n    }, React.createElement(ItemsList, {\n      items: this.state.items,\n      swapItems: (key1, key2) => this.handleSwapItems(key1, key2),\n      removeElement: uuid => this.removeElement(uuid),\n      changePriority: (priority, uuid) => this.handleChangePriority(priority, uuid),\n      changeItemName: (name, uuid) => this.changeItemName(name, uuid),\n      completeTask: uuid => this.handleCompleteTask(uuid),\n      sortByPriority: order => this.handleSortByPriority(order),\n      sortByDate: order => this.handleSortByDate(order),\n      sortByName: order => this.handleSortByName(order),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 66\n      },\n      __self: this\n    })));\n  }\n\n  handleLogOut() {\n    sessionStorage.setItem('isValidLogin', false);\n    sessionStorage.setItem('sessionId', undefined);\n    this.setState({});\n  }\n\n  handleNotify(text) {\n    Container.notifyText = text;\n    Container.showNotify = true;\n    if (Container.notifyTimeoutFunction) clearTimeout(Container.notifyTimeoutFunction);\n    Container.notifyTimeoutFunction = setTimeout(function () {\n      Container.showNotify = false;\n      this.setState({});\n    }.bind(this), 3 * 1000);\n  }\n\n  handleSwapItems(key1, key2) {\n    let items = [...this.state.items];\n    let firstIndex = items.map(x => x.key).indexOf(key1);\n    let secondIndex = items.map(x => x.key).indexOf(key2);\n    items[firstIndex] = items.splice(secondIndex, 1, items[firstIndex])[0];\n    this.setState({\n      items: items\n    });\n    this.handleNotify('Tasks swapped');\n  }\n\n  handleSortByName(order) {\n    let items = [...this.state.items];\n    items.sort((a, b) => a.name > b.name ? 1 : b.name > a.name ? -1 : 0);\n    if (order) items.reverse();\n    this.setState({\n      items: items\n    });\n    this.handleNotify('Tasks sorted by name');\n  }\n\n  handleSortByDate(order) {\n    let items = [...this.state.items];\n    items.sort((a, b) => a.date > b.date ? 1 : b.date > a.date ? -1 : 0);\n    if (order) items.reverse();\n    this.setState({\n      items: items\n    });\n    this.handleNotify('Tasks sorted by date');\n  }\n\n  handleSortByPriority(order) {\n    let items = [...this.state.items];\n    items.sort((a, b) => a.priority > b.priority ? 1 : b.priority > a.priority ? -1 : 0);\n    if (order) items.reverse();\n    this.setState({\n      items: items\n    });\n    this.handleNotify('Tasks sorted by priority');\n  }\n\n  removeElement(uuid) {\n    let items = [...this.state.items];\n    items.splice(items.map(e => {\n      return e.key;\n    }).indexOf(uuid), 1);\n    fetch('/removeTask', {\n      method: 'post',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        \"key\": uuid\n      })\n    });\n    this.setState({\n      items: items\n    });\n    this.handleNotify('Task removed');\n  }\n\n  changeItemName(name, key) {\n    let items = [...this.state.items];\n    items.map((x => x.key === key && (x.name = name)).bind({\n      name: name,\n      key: key\n    }));\n    fetch('/changeTaskName', {\n      method: 'post',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        \"key\": key,\n        \"name\": name\n      })\n    });\n    this.setState({\n      items: items\n    });\n    this.handleNotify('Task name updated');\n  }\n\n  handleChangePriority(priority, key) {\n    let items = [...this.state.items];\n    items.map((x => x.key === key && (x.priority = priority)).bind({\n      priority: priority,\n      key: key\n    }));\n    fetch('/changeTaskPriority', {\n      method: 'post',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        \"key\": key,\n        \"priority\": priority\n      })\n    });\n    this.setState({\n      items: items\n    });\n    this.handleNotify('Task priority updated');\n  }\n\n  handleCompleteTask(key) {\n    let items = [...this.state.items];\n    items.map((x => x.key === key && (x.completed = !x.completed)).bind({\n      key: key\n    }));\n    fetch('/completeTask', {\n      method: 'post',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        \"key\": key\n      })\n    });\n    this.setState({\n      items: items\n    });\n    this.handleNotify('Task marked as complete');\n  }\n\n  handleAddElement(name) {\n    if (name && name.length > 0) {\n      let items = [...this.state.items];\n      let uuid = uuidv4();\n      let date = new Date();\n      let newItem = {\n        key: uuid,\n        date: date,\n        name: name,\n        priority: \"0\",\n        completed: false\n      };\n      fetch('/addTask', {\n        method: 'post',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          \"newItem\": newItem\n        })\n      });\n      items.push(newItem);\n      this.setState({\n        items: items\n      });\n      this.handleNotify('Task added');\n    }\n  }\n\n}\n\nContainer.notifyText = '';\nContainer.showNotify = false;\nexport default Container;","map":{"version":3,"sources":["C:\\Users\\utente\\Desktop\\React tutorial\\react-backed\\todo-list\\src\\components\\Container.js"],"names":["React","ElementPusher","ItemsList","Redirect","uuidv4","require","Container","Component","componentWillUnmount","_isMounted","componentDidMount","sessionStorage","getItem","fetch","method","headers","body","JSON","stringify","sessionId","then","res","json","result","map","o","date","Date","setState","items","constructor","props","state","instances","render","console","log","sessionErr","showNotify","notifyText","handleLogOut","name","handleAddElement","key1","key2","handleSwapItems","uuid","removeElement","priority","handleChangePriority","changeItemName","handleCompleteTask","order","handleSortByPriority","handleSortByDate","handleSortByName","setItem","undefined","handleNotify","text","notifyTimeoutFunction","clearTimeout","setTimeout","bind","firstIndex","x","key","indexOf","secondIndex","splice","sort","a","b","reverse","e","completed","length","newItem","push"],"mappings":"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","sourcesContent":["import React from 'react';\nimport './Container.css';\nimport ElementPusher from './ElementPusher'\nimport ItemsList from './ItemsList'\nimport { Redirect  } from \"react-router-dom\";\nconst uuidv4 = require('uuid/v4');\n\nclass Container extends React.Component {\n\n\tstatic notifyText = '';\n\tstatic showNotify = false;\n\tstatic notifyTimeoutFunction;\n\t_isMounted = false;\n\n\tcomponentWillUnmount() {\n    this._isMounted = false;\n  }\n\n\tcomponentDidMount() {\n\t\tthis._isMounted = true;\n\t\tif(sessionStorage.getItem('isValidLogin'))\n\t\t{\n\t\t\tfetch('/getTasks',{\n\t\t\t   method: 'post',\n\t\t\t\t headers: {'Content-Type':'application/json'},\n\t\t\t\t body: JSON.stringify({\n\t\t\t\t sessionId: sessionStorage.getItem('sessionId')\n\t\t\t\t })\n\t\t\t })\n\t\t\t.then(res => res.json())\n\t\t\t.then(result => {\n\t\t\t\t\tresult = result.map( o => o = {...o, date: new Date(o.date)});\n\t\t\t\t\tif (this._isMounted)\n\t\t\t\t\t\tthis.setState({items: result})\n\t\t\t\t});\n\t\t}\n\t}\n\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tthis.state = {\n\t\t\titems: [],\n\t\t\tinstances : [],\n\t\t};\n\t}\n\n\trender () {\n\t\tif(!sessionStorage.getItem('isValidLogin') || !sessionStorage.getItem('sessionId')) {\n\t\t\tconsole.log('redir to login')\n\t\t\treturn (<Redirect to=\"/login\"/>);\n\t\t}\n\n\t\tif(Container.sessionErr)\n\t\t\treturn (<Redirect to=\"/error\"/>);\n\n\t\treturn (\n\t\t\t<div className=\"w3-container\">\n\t\t\t\t<div className={(Container.showNotify ? \"w3-animate-opacity\" : \"hidden-opacity\") + \" w3-panel w3-margin w3-display-bottomleft w3-dark-grey w3-border w3-border-dark-grey overlay\" }>\n\t\t\t\t  <p>{Container.notifyText}</p>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"w3-container\">\n\t\t\t\t\t<ElementPusher logOut={() => this.handleLogOut()} onClick={(name) => this.handleAddElement(name)} />\n\t\t\t\t</div>\n\t\t\t\t<div>\n\t\t\t\t\t<ItemsList items={this.state.items} swapItems={(key1,key2) => this.handleSwapItems(key1,key2)} removeElement={(uuid) => this.removeElement(uuid)} changePriority={(priority,uuid) => this.handleChangePriority(priority,uuid)} changeItemName={(name,uuid) => this.changeItemName(name,uuid)} completeTask={(uuid) => this.handleCompleteTask(uuid)}  sortByPriority={(order) => this.handleSortByPriority(order)} sortByDate={(order) => this.handleSortByDate(order)} sortByName={(order) => this.handleSortByName(order)}/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n\n\thandleLogOut() {\n\t\tsessionStorage.setItem('isValidLogin', false);\n\t\tsessionStorage.setItem('sessionId', undefined);\n\t\tthis.setState({});\n\t}\n\n\thandleNotify(text) {\n\t\tContainer.notifyText = text;\n\t\tContainer.showNotify = true;\n\n\t\tif(Container.notifyTimeoutFunction)\n\t\t\tclearTimeout(Container.notifyTimeoutFunction)\n\n\t Container.notifyTimeoutFunction =\tsetTimeout(function(){\n\t\t\tContainer.showNotify = false;\n             this.setState({});\n        }.bind(this),3 * 1000);\n\t}\n\n\thandleSwapItems(key1,key2) {\n\t\tlet items = [...this.state.items];\n\t\tlet firstIndex = items.map(x => x.key).indexOf(key1);\n\t\tlet secondIndex = items.map(x => x.key).indexOf(key2);\n\t\titems[firstIndex] = items.splice(secondIndex, 1, items[firstIndex])[0];\n\t\tthis.setState({items: items});\n\t\tthis.handleNotify('Tasks swapped');\n\t}\n\n\thandleSortByName(order) {\n\t\tlet items = [...this.state.items];\n\t\titems.sort((a,b) => (a.name > b.name) ? 1 : ((b.name > a.name) ? -1 : 0));\n\t\tif(order)\n\t\t\titems.reverse();\n\t\tthis.setState({items: items});\n\t\t\tthis.handleNotify('Tasks sorted by name');\n\t}\n\n\thandleSortByDate(order) {\n\t\tlet items = [...this.state.items];\n\t\titems.sort((a,b) => (a.date > b.date) ? 1 : ((b.date > a.date) ? -1 : 0));\n\t\tif(order)\n\t\t\titems.reverse();\n\t\tthis.setState({items: items});\n\t\tthis.handleNotify('Tasks sorted by date');\n\n\t}\n\n\thandleSortByPriority(order) {\n\t\tlet items = [...this.state.items];\n\t\titems.sort((a,b) => (a.priority > b.priority) ? 1 : ((b.priority > a.priority) ? -1 : 0));\n\t\tif(order)\n\t\t\titems.reverse();\n\t\tthis.setState({items: items});\n\t\tthis.handleNotify('Tasks sorted by priority');\n\n\t}\n\n\tremoveElement(uuid) {\n\t\tlet items = [...this.state.items];\n\t\titems.splice(items.map(e => {return e.key}).indexOf(uuid),1);\n\n\t\tfetch('/removeTask',{\n\t\t\t method: 'post',\n\t\t\t headers: {'Content-Type':'application/json'},\n\t\t\t body: JSON.stringify({\n\t\t\t\t\"key\": uuid\n\t\t\t})\n\t\t});\n\n\t\tthis.setState({items: items});\n\t\tthis.handleNotify('Task removed');\n\t}\n\n\tchangeItemName(name,key) {\n\t\tlet items = [...this.state.items];\n\t\titems.map((x => x.key === key && (x.name = name)).bind({name:name,key:key}));\n\n\t\tfetch('/changeTaskName',{\n\t\t\t method: 'post',\n\t\t\t headers: {'Content-Type':'application/json'},\n\t\t\t body: JSON.stringify({\n\t\t\t\t\"key\": key,\n\t\t\t\t\"name\": name\n\t\t\t})\n\t\t});\n\n\t\tthis.setState({items:items});\n\t\tthis.handleNotify('Task name updated');\n\t}\n\n\thandleChangePriority(priority,key) {\n\t\tlet items = [...this.state.items];\n\t\titems.map( (x => x.key === key && (x.priority = priority)).bind({priority: priority, key: key}));\n\n\t\tfetch('/changeTaskPriority',{\n\t\t\t method: 'post',\n\t\t\t headers: {'Content-Type':'application/json'},\n\t\t\t body: JSON.stringify({\n\t\t\t\t\"key\": key,\n\t\t\t\t\"priority\": priority\n\t\t\t})\n\t\t});\n\n\t\tthis.setState({items:items});\n\t\tthis.handleNotify('Task priority updated');\n\t}\n\n\thandleCompleteTask(key) {\n\t\tlet items = [...this.state.items];\n\t\titems.map((x => x.key === key && (x.completed = !x.completed)).bind({key: key}));\n\n\t\tfetch('/completeTask',{\n\t\t\t method: 'post',\n\t\t\t headers: {'Content-Type':'application/json'},\n\t\t\t body: JSON.stringify({\n\t\t\t\t\"key\": key,\n\t\t\t})\n\t\t});\n\n\t\tthis.setState({items:items});\n\t\tthis.handleNotify('Task marked as complete');\n\t}\n\n\thandleAddElement(name) {\n\t\tif(name && name.length>0) {\n\t\t\tlet items = [...this.state.items];\n\t\t\tlet uuid = uuidv4();\n\t\t\tlet date = new Date();\n\t\t\tlet newItem = {\n\t\t\t\tkey: uuid,\n\t\t\t\tdate: date,\n\t\t\t\tname: name,\n\t\t\t\tpriority: \"0\",\n\t\t\t\tcompleted: false,\n\t\t\t};\n\n\n\t\t\tfetch('/addTask', {\n\t\t\t   method: 'post',\n\t\t\t   headers: {'Content-Type':'application/json'},\n\t\t\t   body: JSON.stringify({\n\t\t\t    \"newItem\": newItem\n\t\t\t\t})\n\t\t\t});\n\n\t\t\titems.push(newItem);\n\t\t\tthis.setState({items: items});\n\t\t\tthis.handleNotify('Task added');\n\t\t}\n\t}\n}\n\nexport default Container;\n"]},"metadata":{},"sourceType":"module"}